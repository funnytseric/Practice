<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>HTML/Javascript Test</title>    
    <script type="text/javascript">
        //****************************** Begin of Your Javascript *****************************************************************************************************
        // Please write you javascript here.
		var listCountries = [];
		var listCities = [];
		
		var numCheckedContinent = 1;
		var numCompletedQuery = 0;
		var listCheckedContinent = [{code: "AF", checked: true}, {code: "AS", checked: false}, {code: "EU", checked: false}, {code: "NA", checked: false}, 
									{code: "OC", checked: false}, {code: "SA", checked: false}, {code: "AN", checked: false}];
		
		function changeCheck(index)
		{
			if(listCheckedContinent[index].checked == false)
			{
				listCheckedContinent[index].checked = true;
				numCheckedContinent++;
			}
			else
			{
				listCheckedContinent[index].checked = false;
				numCheckedContinent--;
			}
		}
		
		function queryCountries(index)
		{
			var continentCode = listCheckedContinent[index].code;
			
			var xhttp;
			xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() 
			{
				if (this.readyState == 4 && this.status == 200) 
				{
					var row = JSON.parse(this.responseText);
					
					listCountries[index] = row;
					numCompletedQuery++;
					//alert(numCompletedQuery + ", " + numCheckedContinent);
					if(numCompletedQuery == numCheckedContinent)
					{
						alert("complete all query");
						var testDiv = document.getElementById("testDiv");
						
						var str = "";
						
						for(var i=0; i<7; i++)
						{
							if(listCheckedContinent[i].checked == true)
							{
								for(var j=0; j < listCountries[i].geonames.length; j++)
								{
									str += listCountries[i].geonames[j].toponymName + "<br>";
								}
								str += "<hr>";
							}
						}
						
						
						testDiv.innerHTML = str;
					}
				}
			};
			
			xhttp.open("GET", "http://api.geonames.org/searchJSON?q=&continentCode=" + continentCode + "&maxRows=10&username=funnytseric", true);
			//alert("here");
			xhttp.send();
		}
		
		function getCity()
		{
			alert("1");
			for(var i=0; i<7; i++)
			{
				if(listCheckedContinent[i].checked == true)
				{
					//alert(listCheckedContinent[i].code);
					queryCountries(i);
				}
			}
		}




        //****************************** End of Your Javascript *****************************************************************************************************
	</script>
</head>
<body>
                <!-- ***************************************************************** start of your implementation of HTML ******************************************************** -->
                <h2>
                    Your implemetation</h2>
                <table>
                    <tr>
                        <td>
                            Continent
                        </td>
                        <td>
                            <input type="checkbox" id="checkBoxAF" value="AF" onchange = "changeCheck(0)" checked="checked" />Africa
                            <input type="checkbox" id="checkBoxAS" value="AS" onchange = "changeCheck(1)"/>Asia
                            <input type="checkbox" id="checkBoxEU" value="EU" onchange = "changeCheck(2)"/>Europe
                            <input type="checkbox" id="checkBoxNA" value="NA" onchange = "changeCheck(3)"/>North American
                            <br />
                            <input type="checkbox" id="checkBoxOC" value="OC" onchange = "changeCheck(4)"/>Oceania
                            <input type="checkbox" id="checkBoxSA" value="SA" onchange = "changeCheck(5)"/>South American
                            <input type="checkbox" id="checkBoxAN" value="AN" onchange = "changeCheck(6)"/>Anetatika
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Country
                        </td>
                        <td>
                            <select>
                                <option>-- Please Select --</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            City
                        </td>
                        <td>
                            <select>
                                <option>-- Please Select --</option>
                            </select>
                        </td>
                    </tr>
					<tr>
						<td>
						<!-- as i dont want my page send a request everytime the user check/uncheck a continent options, i use a button to query cities-->
							<button type="button" onclick="getCity()">Get Cities</button>
						</td>
					</tr>
                    <tr>
                        <td colspan="2" height="20px">
                            &nbsp;
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <b>Special Notes</b><br />
                            <i>Please leave your comment or any explanation here for any thing that you want to
                                return back to us.</i>
                            <ol>
                                <li>comment #1</li>
                                <li>comment #2</li>
                                <li>comment #3</li>
                                <li>comment #4</li>
                                <li>etc...</li>
                            </ol>
                        </td>
                    </tr>
                </table>
				
				<div id = "testDiv">
					123
				</div>
                <!-- ***************************************************************** end of your implementation of HTML ******************************************************** -->
</body>
</html>
